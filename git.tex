\documentclass{beamer}
\usepackage[utf8x]{inputenc}
\usepackage{ucs}
\usepackage[portuguese]{babel}
\usepackage[T1]{fontenc}
\usepackage{amsmath}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{makeidx}
\usepackage{graphicx}
\usepackage{lmodern}
\usepackage{verbatim}

\usetheme{CambridgeUS}

%\AtBeginSection[]
%{
%\begin{frame}
%\frametitle{Sumário}
%\tableofcontents[currentsection]
%\end{frame}
%}

\pgfdeclareimage[height=.5cm]{logo}{logo}
\logo{\pgfuseimage{logo}}


\author{Fernando Michelotti}
\title{Programação Não Linear com GIT}
\begin{document}

\frame{\titlepage}
\section{Sumario}

\frame{\tableofcontents}

\section{GIT: SCM ou 'the information manager from hell'}

\begin{frame}
\frametitle{O que é GIT?}

\textbf{Sou um bastardo egoísta e nomeio todos os meus projetos em homenagem a mim mesmo. Primeiro Linux, agora GIT.}
- Linus Torvalds

\begin{itemize}
\item \textbf{Linux}: Híbrido de Linus e Mimix
\item \textbf{Git}: gíria britânica que descreve uma pessoa idiota ou sem valor.
\end{itemize}

\end{frame}

\begin{frame}
\frametitle{O que é GIT?}

GIT é um Sistema de Controle de Versões Disitribuído (Distributed Revision Control - DRC) e Gerenciamento de Código Fonte(Source Code Manager SCM).
\begin{itemize}
\item Ênfase em velocidade
\item Cada diretório de trabalho é um repositório completo - Não depende de acesso à rede ou um servidor central.
\item GPL2
\end{itemize}

\end{frame}


\begin{frame}
\frametitle{Mas quem usa GIT?}

\pgfdeclareimage[width=12cm,height=6cm]{who_uses_git}{who_uses_git}
\pgfuseimage{who_uses_git}<1>

\end{frame}

\begin{frame}
\frametitle{Mas quem hospeda repositórios GIT?}

\pgfdeclareimage[width=12cm,height=6cm]{hosting}{hosting}
\pgfuseimage{hosting}<1>

\end{frame}

\begin{frame}
\frametitle{A Filosofia do GIT}
\begin{itemize}
\item Commit early, commit often (Release early, release often - Lei de Linus);
\item Cada commit representa uma idéia e uma alteração;
\begin{itemize}
\item Facilita a leitura das alterações (patches)
\item Facilita reverter alterações indesejadas no futuro
\end{itemize}
\item O diretório de trabalho, index e repositório são rascunhos, uma laboratório, e não o repositório oficial do projeto.
\end{itemize}
\end{frame}

\section{Trabalhando com o GIT}
\begin{frame}
\frametitle{Workflow}

\pgfdeclareimage[width=5cm,height=6cm]{Git_data_flow_simplified}{Git_data_flow_simplified}
\pgfuseimage{Git_data_flow_simplified}<1>

\end{frame}

\begin{frame}
\frametitle{Workflow: Publicando alterações sem repositório}

\pgfdeclareimage[width=5cm,height=6cm]{git-workflow-rsync.png}{git-workflow-rsync.png}
\pgfuseimage{git-workflow-rsync.png}<1>

\end{frame}

\begin{frame}
\frametitle{Comandos de uso diário}


\begin{itemize}
\item git add
\item git commit
\item git diff
\item git log
\item git push
\item git pull
\item git fetch
\item git rebase
\item git show
\item gitk
\end{itemize}


\end{frame}

\begin{frame}
\frametitle{GIT: Comandos de transporte de dados}

\pgfdeclareimage[width=6cm,height=7cm]{git-transport.png}{git-transport.png}
\pgfuseimage{git-transport.png}<1>

\end{frame}

\begin{frame}
\frametitle{git diff}


Apenas repara em arquivos "rastreados".

\begin{itemize}
\item \textbf{git diff}: diferenças entre a área de trabalho (workspace) e o índice (index)
\item \textbf{git diff --cached}: diferenças entre índice (index) e o repositório local
\item \textbf{git diff HEAD}: diferenças entre a área de trabalho (workspace) e o repositório local.
\end{itemize}
\end{frame}

\begin{frame}
\frametitle{História}

\begin{itemize}
\item \textbf{git log}
\item \textbf{git log <commit ID>}
\begin{itemize}
\item shows history before that commit
\item ex. git log HEAD
\item ex.  git log f74e955797c273c0398494ab33bf6e965c3b97a4
\end{itemize}
\item \textbf{git log -p}
\begin{itemize}
\item shows log as a series of patches
\end{itemize}
\end{itemize}

\end{frame}


\begin{frame}
\frametitle{GIT: trabalando com alterações}


\begin{itemize}
\item \textbf{git add <file>}: adds a file to the Index
\item \textbf{git commit}:  commits added changes to the local repo
\end{itemize}

Detalhes importantes:

\begin{itemize}
\item Arquivos que não foram adicionados ao índice (index) não são incluídos no commit
\item Adicionando e fazendo commits para cada arquivo, individualmente, torna o gerenciamento do código mais fácil pois reduz o tamanho de cada commit/patch.
\end{itemize}

\end{frame}

\begin{frame}
\frametitle{GIT: Alterando a história}

De acordo com a Lei de Murphy: Depois de um commit você irá encontrar bugs em seu código.

Você pode fazer um novo commit com a correção do bug

OU 

Você pode "amend" (aperfeiçoar) o commit anterior

Corrija seu código e execute:

\textbf{git add <file>}

para adicionar seu código ao index e

\textbf{git commit --amend}

para modificar o commit no repositório local.
\end{frame}


\begin{frame}
\frametitle{GIT: Alterando a história}

Uma reescrita completa do histórico:

\textbf{git rebase -i <commit ID>}

\begin{itemize}
\item Pode reordenar commits
\item Pode editar commits
\item Pode "espremer" (squash) um commit em outro
\end{itemize}


\end{frame}

\section{Hooks}
\begin{frame}
\frametitle{GIT: Hooks}

Hooks são scripts executados em determinados momentos por comandos do GIT. Encontram-se na pasta \textbf{.git/hooks/}

Para habilitar um hook, nomeie o arquivo com o nome do evento e o proporcione permissões de execução.

\textbf{chmod a+x <file>}

EX.

\textbf{git push}

hooks: pre-commit, post-update
\end{frame}

\begin{frame}
\frametitle{GIT: Exemplo de Hook}

\textbf{.git/hooks/pre-commit}
\verbatiminput{hook_pre-commit.sh}
\end{frame}

\section{GIT Blame}
\begin{frame}
\frametitle{GIT: encontrando o culpado}


\begin{itemize}
\item \textbf{git blame <file>}: mostra quem fez o commit de cada linha do arquivo
\item \textbf{git blame <file> <commit ID>}: mostra o histórico das linhas antes do commit
\end{itemize}


\end{frame}

\end{document}
